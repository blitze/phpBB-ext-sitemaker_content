(function(){var i,y=[].indexOf||function(t){for(var e=0,s=this.length;e<s;e++)if(e in this&&this[e]===t)return e;return-1};i=function(){function p(t,e,s){var n,r,i,o,l,_,u,h,c;if(null==e&&(e=p.options),null==s&&(s=!1),this.__els=s?[t]:document.querySelectorAll(t),!this.__els)return this;for(r=o=0,_=(h=this.__els).length;o<_;r=++o)for((i=h[r]).style.position="relative",this.__kids[r]=i.children.length,l=0,u=(c=i.children).length;l<u;l++)(n=c[l]).style.position="absolute",n.style.margin=0;this._reset(this._merge(p.options,e)),this._respond(),this._docontext(),this._doresize(),this._doscroll()}return p.prototype.__els=[],p.prototype.__kids=[],p.prototype.__watch=null,p.prototype.__adopt=!1,p.prototype.__width=null,p.prototype.__rows=[0],p.prototype.__columns=[0],p.prototype.__scroll={watch:null,fn:null},p.prototype.__devices=null,p.prototype.__current=null,p.prototype.__screen=null,p.prototype.__small=null,p.prototype.__mobile=null,p.prototype.__tablet=null,p.prototype.__desktop=null,p.prototype.__tv=null,p.prototype.__events=[],p.prototype.__context=null,p.options={context:"window",mobile:420,tablet:768,desktop:992,tv:1200},p.prototype._make=function(t,e){return{device:t,screen:e,columns:1,gutters:{column:0,row:0,force:!1}}},p.prototype._reset=function(t){return this.__context=t.context,this.__small=this._make("small",0),this.__mobile=this._make("mobile",t.mobile),this.__tablet=this._make("tablet",t.tablet),this.__desktop=this._make("desktop",t.desktop),this.__tv=this._make("tv",t.tv),this.__columns=[0],this.__devices=["small"],this.__current={}},p.prototype._device=function(r,t,e,s){var n,i;return this.__els?(!1===t?this.__devices=function(){var t,e,s,n;for(n=[],t=0,e=(s=this.__devices).length;t<e;t++)(i=s[t])!==r&&n.push(i);return n}.call(this):((n=function(){switch(!1){case"tv"!==r:return this.__tv;case"desktop"!==r:return this.__desktop;case"tablet"!==r:return this.__tablet;case"mobile"!==r:return this.__mobile}}.call(this)).columns=t,this.gutters(e,s,n),y.call(this.__devices,r)<0&&this.__devices.push(r)),this._respond()):this},p.prototype._respond=function(t){var e,s,n,r,i,o,l;if(null==t&&(t=window.innerWidth),i=function(t,e){var s;return l.__screen=function(){switch(!1){case!(t>=this.__tv.screen):return this.__tv;case!(t>=this.__desktop.screen):return this.__desktop;case!(t>=this.__tablet.screen):return this.__tablet;case!(t>=this.__mobile.screen):return this.__mobile;default:return this.__small}}.call(l),s=l.__current.device,l.__current=function(){var t,e,s,n;switch(!1){case t=this.__screen.device,y.call(this.__devices,t)<0:return this.__screen;case!("tv"===this.__screen.device&&0<=y.call(this.__devices,"tv")):return this.__tv;case!(("tv"===(e=this.__screen.device)||"desktop"===e)&&0<=y.call(this.__devices,"desktop")):return this.__desktop;case!(("tv"===(s=this.__screen.device)||"desktop"===s||"tablet"===s)&&0<=y.call(this.__devices,"tablet")):return this.__tablet;case!(("tv"===(n=this.__screen.device)||"desktop"===n||"tablet"===n||"mobile"===n)&&0<=y.call(this.__devices,"mobile")):return this.__mobile;default:return this.__small}}.call(l),l.__current.device!==s&&l._emit("grid:device",null,[l.__current.device,s]),l.grid(!1,e)},"self"===(l=this).__context){for(o=[],s=0,n=(r=this.__els).length;s<n;s++)e=r[s],o.push(i(e.offsetWidth,[e]));return o}return i(t,this.__els)},p.prototype._docontext=function(){return"self"!==this.__context?null:(this._respond(),this.__watch=setTimeout((t=this,function(){return t._docontext()}),220));var t},p.prototype._doresize=function(){var t,e;return"self"===this.__context?null:(t=null,window.addEventListener("resize",(e=this,function(){if(null==t)return t=setTimeout(function(){return t=null,e._respond()},66)}),!0))},p.prototype._grow=function(){var t,l,e,s,n,r,i,o,_;if(null==this.__scroll.fn||null!=this.__scroll.watch)return this;for(i=[],t=s=0,n=(r=this.__els).length;s<n;t=++s)l=r[t],o=getComputedStyle(l),e=parseInt(o.getPropertyValue("height")),document.body.scrollTop>=e+l.offsetTop-window.innerHeight?(this._emit("grid:scrolled",l,[this.__current.device]),this.__scroll.watch=!0,_=t,i.push(this.__scroll.fn(function(o){return function(){var t,e,s,n,r,i;if(!arguments.length||!arguments[0])return o.__scroll.watch=null,o;for(n=(e=arguments[s=0].constructor===Array?arguments[0]:arguments).length;s<n;s++)t=e[s],r=l.children[0].tagName.toLowerCase(),(i=document.createElement(r)).innerHTML=t,l.appendChild(i);return o._sync(_),o.__scroll.watch=null}}(this)))):i.push(void 0);return i},p.prototype._doscroll=function(){var t,e;return t=null,window.addEventListener("scroll",(e=this,function(){if(null==t)return t=setTimeout(function(){return t=null,e._grow()},66)}),!0)},p.prototype._isInt=function(t){return null!=t&&!isNaN(t)&&(0|(e=parseFloat(t)))===e;var e},p.prototype._clone=function(t){var e,s;if(null==t||"object"!=typeof t)return t;for(e in s={},t)s[e]=this._clone(t[e]);return s},p.prototype._merge=function(t,e){var s,n,r;for(s in n=this._clone(t),e)r=e[s],n[s]=r;return n},p.prototype._x=function(t,e){var s,n;return s=1,n=t.getAttribute("data-ag-x"),this._isInt(n)&&(s=parseInt(n)),e<s?e:s<1?1:s},p.prototype._spacing=function(t){var e,s;return e={},s=getComputedStyle(t),e.pl=parseInt(s.paddingLeft),e.pr=parseInt(s.paddingRight),e.bl=parseInt(s.getPropertyValue("border-left-width")),e.br=parseInt(s.getPropertyValue("border-right-width")),e},p.prototype._giant=function(t,e){var s;return null==t&&(t=-1),null==e&&(e=-1),t===e&&-1<t?t:t===e&&-1===t?this.__columns.indexOf(Math.max.apply(null,this.__columns)):t+(s=this.__columns.slice(t,+e+1||9e9)).indexOf(Math.max.apply(null,s))},p.prototype._midget=function(t,e){var s;return null==t&&(t=-1),null==e&&(e=-1),t===e&&-1<t?t:t===e&&-1===t?this.__columns.indexOf(Math.min.apply(null,this.__columns)):t+(s=this.__columns.slice(t,+e+1||9e9)).indexOf(Math.min.apply(null,s))},p.prototype._clearClass=function(t){var e;return""!==(e=t.className.replace(/(?:^|\s)(ag-col-.+?)|(ag-row-.+?)(?!\S)/gim,""))&&(e=e.trim()+" "),e},p.prototype._emit=function(t,e,s){var n,r,i,o,l;for(l=[],r=0,i=(o=this.__events).length;r<i;r++)(n=o[r])[0]===t?l.push(n[1].apply(e,[t].concat(s))):l.push(void 0);return l},p.prototype._gutters=function(t){var e;return this.__els&&null!=t?this._isInt(t)?{column:parseInt(t),row:parseInt(t)}:(e={column:this.__small.gutters.column,row:this.__small.gutters.row},this._isInt(t.column)&&(e.column=parseInt(t.column)),this._isInt(t.row)&&(e.row=parseInt(t.row)),e):this},p.prototype._grid=function(t,e,s,n){var r,i,o,l,_,u,h,c,p,a,d,f,m,v,g;for(null==n&&(n=!1),n&&(e.style.position="absolute",e.style.margin=0),s<(r=this._midget())+(d=this._x(e,s))&&(r-=r+d-s),_=r*this.__width+r*this.__current.gutters.column,g=d*this.__width+(d-1)*this.__current.gutters.column,a=this._spacing(e),m=this._giant(r,r+d-1),e.style.width=g-a.pl-a.pr-a.bl-a.br+"px",e.style.top=this.__columns[m]+"px",e.style.left=_+"px",e.className=this._clearClass(e),this.__columns[m]=this.__columns[m]+e.offsetHeight+this.__current.gutters.row,f="",v=[],o=[],p=[],i=l=u=r,h=r+d-1;u<=h?l<=h:h<=l;i=u<=h?++l:--l)e.className+=f+"ag-col-"+(i+1),c=this.__rows[i],y.call(v,c)<0&&(e.className+=" ag-row-"+(this.__rows[i]+1)),v.push(this.__rows[i]),this.__rows[i]++,f=" ",this.__columns[i]=this.__columns[m],o.push(i+1),p.push(this.__rows[i]);return t.style.height=this.__columns[this._giant()]+"px",this._emit("item:stacked",e,[t,p,o,this.__current.device])},p.prototype._sync=function(t){var e,s,n,r,i,o,l;if((r=this.__kids[t])<(s=this.__els[t].children.length)){for(l=[],e=n=i=r,o=this.__kids[t]=s;i<=o?n<o:o<n;e=i<=o?++n:--n)l.push(this._grid(this.__els[t],this.__els[t].children[e],this.__columns.length,!0));return l}},p.prototype.gutters=function(t,e,s){var n;return null==e&&(e=!1),null==s&&(s=this.__small),this.__els&&(n=this._gutters(t),s.gutters={column:n.column,row:n.row,force:!!e}),this},p.prototype.grid=function(n,t){var e,s,r,i,o,l,_,u,h;if(null==t&&(t=this.__els),!this.__els)return this;if(n&&(this.__small.columns=n),s=this.__current,n=s.columns,!this._isInt(n))return this;for(o=0,_=t.length;o<_;o++){for(r=t[o],this.__columns=function(){var t,e,s;for(s=[],t=1,e=n;1<=e?t<=e:e<=t;1<=e?t++:t--)s.push(0);return s}(),this.__rows=this.__columns.slice(0),(i=this._clone(s.gutters)).force||this.gutters(r.getAttribute("data-ag-gutters")||{column:r.getAttribute("data-ag-gutters-column"),row:r.getAttribute("data-ag-gutters-row")},s),this.__width=(r.offsetWidth-(n-1)*s.gutters.column)/n,l=0,u=(h=r.children).length;l<u;l++)e=h[l],this._grid(r,e,n);s.gutters=i,this._emit("grid:done",r,[s.device])}return this},p.prototype.apply=function(){var t,e,s,n;for(t=e=0,s=(n=this.__kids).length;e<s;t=++e)n[t],this._sync(t);return this},p.prototype.scroll=function(t){return!1===t?(this.__scroll.fn=null,this.__scroll.watch=null):"function"!=typeof t||(this.__scroll.fn=t),this},p.prototype.mobile=function(t,e,s){return null==e&&(e={}),null==s&&(s=!1),this._device("mobile",t,e,s),this},p.prototype.tablet=function(t,e,s){return null==e&&(e={}),null==s&&(s=!1),this._device("tablet",t,e,s),this},p.prototype.desktop=function(t,e,s){return null==e&&(e={}),null==s&&(s=!1),this._device("desktop",t,e,s),this},p.prototype.tv=function(t,e,s){return null==e&&(e={}),null==s&&(s=!1),this._device("tv",t,e,s),this},p.prototype.on=function(t,e){return"function"!=typeof e||this.__events.push([t,e]),this},p.prototype.off=function(t,e){var s,n,r,i,o,l;if(null==e&&(e=null),null==t)return this.__events=[],this;for(r=[],s=i=0,o=(l=this.__events).length;i<o;s=++i)((n=l[s])[0]!==t||null!=e&&e.toString()!==n[1].toString())&&r.push(n);return this.__events=r,this},p}(),window.addEventListener("load",function(){var t,e,s,n,r;for(r=[],e=0,s=(n=document.querySelectorAll("[data-awesome-grid]")).length;e<s;e++)t=n[e],r.push(new i(t,i.options,!0).grid(t.getAttribute("data-awesome-grid")));return r},!0),"undefined"!=typeof window&&null!==window&&(window.AwesomeGrid=i),"function"==typeof define&&define.amd&&define("AwesomeGrid",[],function(){return i}),("undefined"!=typeof module&&null!==module?module.exports:void 0)&&(module.exports=i)}).call(this);