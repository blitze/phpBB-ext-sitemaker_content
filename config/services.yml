parameters:
    tables.blitze.content_types: '%core.table_prefix%sm_content_types'
    tables.blitze.content_fields: '%core.table_prefix%sm_content_fields'

imports:
    - { resource: actions.yml }
    - { resource: blocks.yml }
    - { resource: controllers.yml }
    - { resource: form.yml }
    - { resource: listeners.yml }
    - { resource: template.yml }
    - { resource: views.yml }

services:

    blitze.content.action_handler:
        class: blitze\content\services\action_handler
        arguments:
            - '@service_container'

    blitze.content.builder:
        class: blitze\content\services\builder
        arguments:
            - '@auth'
            - '@language'
            - '@request'
            - '@service_container'
            - '@user'
            - '@blitze.content.fields'
            - '@blitze.content.types'
            - '@blitze.content.form'
            - '%core.root_path%'
            - '%core.php_ext%'

    blitze.content.comments:
        class: blitze\content\services\comments
        arguments:
            - '@auth'
            - '@config'
            - '@content.visibility'
            - '@dbal.conn'
            - '@controller.helper'
            - '@pagination'
            - '@request'
            - '@template'
            - '@user'
            - '@blitze.content.form'
            - '@blitze.sitemaker.forum.data'
            - '%core.root_path%'
            - '%core.php_ext%'

    blitze.content.fields:
        class: blitze\content\services\fields
        arguments:
            - '@config'
            - '@content.visibility'
            - '@controller.helper'
            - '@dispatcher'
            - '@language'
            - '@blitze.content.template'
            - '@user'
            - '@blitze.content.form.fields.factory'
            - '@blitze.content.helper'

    blitze.content.form:
        class: blitze\content\services\form\form
        arguments:
            - '@request'
            - '@template_context'
            - '@language'
            - '@blitze.content.form.fields.factory'
            - '@blitze.sitemaker.template'

    blitze.content.form.fields_collection:
        class: phpbb\di\service_collection
        arguments:
            - '@service_container'
        tags:
            - { name: service_collection, tag: sitemaker.content.form.field }

    blitze.content.form.fields.factory:
        class: blitze\content\services\form\fields_factory
        arguments:
            - '@language'
            - '@blitze.content.form.fields_collection'

    blitze.content.helper:
        class: blitze\content\services\helper
        arguments:
            - '@auth'
            - '@config'
            - '@user'
            - '%core.root_path%'
            - '%core.php_ext%'

    blitze.content.mapper.factory:
        class: blitze\content\model\mapper_factory
        arguments:
            - '@dbal.conn'
            - mappers:
                types: '%tables.blitze.content_types%'
                fields: '%tables.blitze.content_fields%'

    blitze.content.topic:
        class: blitze\content\services\topic
        arguments:
            - '@config'
            - '@content.visibility'
            - '@controller.helper'
            - '@dispatcher'
            - '@language'
            - '@user'
            - '@blitze.content.helper'

    blitze.content.types:
        class: blitze\content\services\types
        arguments:
            - '@cache.driver'
            - '@blitze.content.mapper.factory'

    blitze.content.views_collection:
        class: phpbb\di\service_collection
        arguments:
            - '@service_container'
        tags:
            - { name: service_collection, tag: sitemaker.content.view }

    blitze.content.views.factory:
        class: blitze\content\services\views\views_factory
        arguments:
            - '@language'
            - '@blitze.content.views_collection'
